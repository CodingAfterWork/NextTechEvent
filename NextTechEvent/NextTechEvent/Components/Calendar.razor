@using System.Globalization
@using NextTechEvent.Data.Index
@inject INextTechEventApi _api

<table border="1">
    <tr>
        <th></th>
        @for (int month = 1; month <= 12; month++)
        {
            <th>@CultureInfo.CurrentCulture.DateTimeFormat.GetMonthName(month)</th>
        }
    </tr>
    @for (int day = 1; day <= 31; day++)
    {
        <tr>
            <td>@day</td>
            @for (int month = 1; month <= 12; month++)
            {
                <td>
                    @if (DateTime.DaysInMonth(year, month) >= day)
                    {
                        var d = new DateOnly(year, month, day);
                        @d.DayOfWeek<br />
                        <h2>@(dates.FirstOrDefault(a=>a.Date==d)?.Count)</h2>

                    }
                </td>
            }
        </tr>
    }
</table>
@code {
    int year = 2022;
    List<ConferenceCountByDate> dates = new();


    protected override async Task OnParametersSetAsync()
    {
        DateOnly start = new DateOnly(year, 1, 1);
        DateOnly end = new DateOnly(year, 12, 31);
        dates = await _api.GetConferenceCountByDate(start, end);
        await base.OnParametersSetAsync();
    }
}
